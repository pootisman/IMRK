\documentclass[a4paper, titlepage, 10pt]{article}
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english, russian]{babel}
\usepackage{indentfirst}
\usepackage{tabularx}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{float}
\usepackage{tikz}
\hoffset=-2.1cm
\voffset=-1.6cm
\setlength{\parindent}{1cm}
\textwidth= 16cm
\textheight = 24cm
\newcommand{\HRule}{\rule{\linewidth}{0.5mm}}
\newcommand{\textunderscript}[1]{$_{\text{#1}}$}
\usetikzlibrary{shapes, arrows}
\begin{document}
\include{./title}
\tableofcontents
\newpage
\section{Техническое задание.}
\indent Реализовать программу, производящую имитационое моделирование передачи сигнлов в ридиоканале с множеством приёмников и передатчиков. Вторичной задачей является уменьшение времени работы программы.
\appendix
\section{Описание модели канала.}
При написании программы использовались следующие модели с дискретным временем: \\
Модель 1:
\begin{enumerate}
  \item{Зависимость мощности сигнала L от расстоянии расчитывается по следующему уравнению:\\
  \begin{center}
    $
    L = \frac{100 \cdot P}{d^5 + a}
    $
  \end{center}
  где P - Мощность передатчика в Вт.\\
  d - Расстояние между передатчиком и приёмником.\\
  a - Зачение силы затухания в точке нахождения приёмника.\\}
  \item{Значения переменной а в разных точках определяются матрицей случайных гауссовских величин, корреллированных в пространстве.}
\end{enumerate}
Модель 2:
\begin{enumerate}
  \item{Зависимость мощности сигнала в этой модели вычисляется по следующей формуле: \\
    \begin{center}
      $
      L = P - (20 \log_{10}(\frac{4 \cdot \pi}{C/f}) - 2*H_r + 40 \log_{10}(d))
      $
    \end{center}
    где С - скорость света (распространения сигнала в среде)\\
    f - частота, на которой идёт передача\\
    P - мощность передатчика в Дб.\\
  }
\end{enumerate}
Модель 3:
\begin{enumerate}
 \item{Зависимость мощности сигнала в этой модели вычисляется по следующей формуле: \\
   \begin{center}
     $
     L = P - [40 (1 - 4 \cdot 10^{-3} \cdot \Delta h_b)] \log_{10} R + 18 \log_{10} \Delta h_b - 21 \log_{10}f - 80
     $
   \end{center}
   где f - частота, на которой идёт передача. \\
   $h_b$ - разница между высотой антенны передатчика и средней высотой зданий. \\
   R - расстояние между приёмником и передатчиком (км). \\
 }
\end{enumerate}
Модель 4:
\begin{enumerate}
 \item{Зависимость мощности сигнала в этой модели вычисляется по следующей формуле: \\
   \begin{center}
     $
     L = P + 10 \log_{10}[(\frac{\lambda}{4 \pi R})^2] + 10 \log_{10} [\frac{\lambda}{2 \pi^2 r}(\frac{1}{\theta} - \frac{1}{2 \pi + \theta})] + 10 \log_{10}[\frac{(2.35)^2 (\Delta h_b \sqrt{\frac{d}{\lambda}})^{1.8}}{R^{2(1 - 4 \cdot 10^{-3} \Delta h_b)}}]
     $
   \end{center}
   где $\lambda$ - длина волны, на которой идёт передача. \\
   $h_b$ - разница между высотой антенны передатчика и средней высотой зданий. \\
   $\theta = \tan^{-1}(\frac{|\delta h_m|}{x})$ \\
   $r = \sqrt{(\Delta h_m)^2 - x^2}$
   $h_m$ - разница между высотой антенны приёмника и крыши здания. \\
   x - расстояние от передатчика до стены. \\
   R - расстояние между приёмником и передатчиком (км). \\
 }
\end{enumerate}
При этом, на каждом шаге программы производится решение об удалении абонента из сети и о добавлении абонентов в сеть. Решение об удалении принимается следующим образом:
\begin{enumerate}
 \item{Генерирование величин P, распределённых по равномерному закону в диапазоне [0;1] для каждого из абонентов.}
 \item{Сравнение всех сгенерированных величин с заданной вероятностью исчезновения.}
 \item{Те абоненты, для которых значение величины P меньше вероятности исчезновения, удаляются.}
\end{enumerate}
Количество подключаемых за один шаг абонентов определяется геометрическим распределением с задаваемым параметром P:
\begin{enumerate}
 \item{Вероятность подключения i абонентов вычисляется по следующей формуле: $ p^i \cdot (1-p)$.}
 \item{Математическое ожидание (среднее количество абонентов подключающихся за один шаг) определяется по следующей формуле: $M = \frac{P}{1-P}$}
\end{enumerate}

\indent На вход программе подаются параметры моделирования, такие как:
\begin{enumerate}
 \item{Колчество приёмников и передатчиков.}
 \item{Размер решётки для моделирования, высота/ширина.}
 \item{Использование графического вывода.}
 \item{Использование вывода в файл с указанием названия файла.}
 \item{Ввод из файла приёмников и передатчиков.}
 \item{Тип модели, который будет рассчитываться.}
 \item{Вероятность появления нового абонента в сети.}
 \item{Значение параметра p для геометрического распределения.}
 \item{Запрос краткой справки.}
\end{enumerate}
\indent Генерирование координат источников и передатчиков происходит по равномерному закону распределения. На начальной стадии разработки каждому передатчику сопоставлялся приёмник (абонент). Так, при расчёте проверялось, принадлежит ли абонент данному передатчику. Если принадлежит, то мощность передатчика относилась к сигналу, если абонент не принадлежал передатчику, то мощность относилась к шуму. Результатом моделирования являются уровни отношения сигнал/шум для каждого из абонентов. При генерирования матрицы величин "a" использовалась нереалистичная модель, т.е. некоррелированные гауссовские величины.\\
\indent В программе реализован вывод на экран приемников и передатчиков. Цвет антенны приёмника зависит от силы сигнала, который он принимает. Синяя антенна соответствует передатчику, серая линия, соединяющяя приёмник с передатчиком, показывает, какой приёмник соответствует передатчику и наоборот. Рядом с приёмниками и передатчиками выводятся их порядковые номера, ниже представлен снимок окна программы.\\

\begin{figure}[H]
 \begin{center}
  \includegraphics[width=0.7\textwidth]{IMRC_out.png}
  \caption{Графический вывод программы.}
 \end{center}
\end{figure}
\addcontentsline{toc}{figure}{Графический вывод программы.}

\indent Последняя версия программы работает по следующему алгоритму:\\
\begin{enumerate}
 \item{Обработка параметров коммандной строки.}
 \item{Подготовка данных модели, генерирование передатчиков и приёмников, матрицы затуханий.}
 \item{Обсчёт модели, на данном пункте следует заострить внимание. Программа узнаёт сколько рабочих ядер на процессоре используемой машины при помощи функции sysconf. При расчёте модели рассматривается необходимость обсчёта конкретного абонента, если абонент не изменил свои координаты и при этом не произошло изменений в параметрах точек доступа, то мощность сигнала для абонента не рассчитывается.} 
\end{enumerate}

\section{Проблемы, возникшие при разработке.}
\indent При попытке ускорения работы программы был использован метод параллельных вычислений. Была использована библиотека Posix Threads и OpenMP. При написании первой версии поточной программы не было необходимости в использовании механизмов защиты памяти от "гонок" потоков, так как запись происходила в разные сегменты памяти. Однако, ускорения работы программы не толко не произошло, программа начала работать медленнее. Была рассмотрена возможная причина такого поведения программы, заключавшаяся в конфликте при считывании данных из памяти. Были так же рассмотрены несколько решений данной проблемы:
\begin{enumerate} 
 \item{Выделять дополнительную память для копий конфликтных областей в отдельных потоках, передавая указатели на области памяти в потоки. Данный способ позволил выделить память с разными адресами, однако к желаемому результату это не привело.}
 \item{Выделять память страницами, т.е., получить размер страницы памяти, выделить необходимое кол-во страниц для хранения массива и скопировать массив в данную область. Указатель на выделенную область далее передаётся в поток, к ускорению программы это также не привело.}
\end{enumerate}
\indent В процессе решения данной проблемы я пытался рассмотреть такой аспект как человеческий фактор, т.е. ошибка при программировании распределения потоков. Я воспользовался библиотекой OpenMP, так как задание параметров распараллеливания в ней производится весьма простым методом (при помощи директивы компилятора \#pragma). Но, к сожалению, данная попытка обернулась неудачей. Однако, в результате рассмотрения уже написанного кода и написания нового кода удалось добиться ускорения почти в два раза. Причина ошибки не была установлена.

\section{Результаты проделанной работы.}
\indent Ниже приведены примеры времени работы программы с потоками и без для разных количеств приёмников и передатчиков. Измерение времени работы производилось при помощи утилиты time, при этом, количество приёмников и передатчиков не менялось. Считаю нужным заметить, что при симуляции нескольких шагов выйгрыш от многопоточности переходит в проигрыш. Однако, я так-же заметил, что при увеличении количества приёмников до определённого значения многопоточная версия снова работает быстрее.
\begin{figure}[H]
 \begin{center}
  \includegraphics[width=0.7\textwidth]{plot_sconst.pdf}
  \caption{Время работы программы с постоянным кол-вом. передатчиков.}
 \end{center}
\end{figure}

\addcontentsline{toc}{figure}{Время работы программы с постоянным кол-вом. передатчиков.}
\begin{figure}[H]
 \begin{center}
  \includegraphics[width=0.7\textwidth]{plot_sdyn.pdf}
  \caption{Время работы программы c кол-вом. передатчиков, равным кол-ву. приёмников.}
 \end{center}
\end{figure}
\addcontentsline{toc}{figure}{Время работы программы c кол-вом. передатчиков, равным кол-ву. приёмников.}

\section{Список литературы.}
\begin{enumerate}
  \item{GUIDELINES FOR EVALUATION OF RADIO TRANSMISSION TECHNOLOGIES FOR IMT-2000.}
\end{enumerate}

\end{document}
